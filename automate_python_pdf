##### importanto arquivos em pdf e neste caso este noa é criptografado

import PyPDF2

pdf_ler_arquivo = open('C:/Users/cesar.tomazinho/Downloads/automate_online-materials/meetingminutes.pdf', 'rb')
pdf_objeto_arquivo = PyPDF2.PdfFileReader(pdf_ler_arquivo)
#pdf_objeto_arquivo.numPages
pdf_obj_pagina = pdf_objeto_arquivo.getPage(0) ### este seria um objeto de um objeto(uma parte do objeto seria a pagina)
pdf_obj_pagina.extractText()


###### creating pdf files / copying pages of one into another

### importing the files from the system
import PyPDF2
pdf_ler_arquivo_1 = open('C:/Users/cesar.tomazinho/Downloads/automate_online-materials/meetingminutes.pdf','rb')
pdf_ler_arquivo_2 = open('C:/Users/cesar.tomazinho/Downloads/automate_online-materials/meetingminutes2.pdf','rb')

### transforming them into python objects
pdf_objeto_arquivo_1 = PyPDF2.PdfFileReader(pdf_ler_arquivo_1)
pdf_objeto_arquivo_2 = PyPDF2.PdfFileReader(pdf_ler_arquivo_2)

### creating an new object for writing only
pdfWriter = PyPDF2.PdfFileWriter()


### mixing the pages in a document
for pag_num in range(pdf_objeto_arquivo_1.numPages):
    pdf_objeto = pdf_objeto_arquivo_1.getPage(pag_num)
    pdfWriter.addPage(pdf_objeto)
#pdf_objeto.extractText()

for pag_num2 in range(pdf_objeto_arquivo_2.numPages):
    pdf_objeto2 = pdf_objeto_arquivo_2.getPage(pag_num2)
    pdfWriter.addPage(pdf_objeto2)
    
pdf_output_file = open('C:/Users/cesar.tomazinho/Downloads/automate_online-materials/novo_mix.pdf','wb')
pdfWriter.write(pdf_output_file)
pdf_output_file.close()
pdf_ler_arquivo_1.close()
pdf_ler_arquivo_2.close()


# getting all the pdfs files from a directory and copy them
import PyPDF2, os

pdf_files = []


for filename in os.listdir('.'):
    if filename.endswith('.pdf'):
        pdf_files.append(filename)
pdf_files.sort(key=str.lower)

#print(pdf_files)

pdf_writer_object=PyPDF2.PdfFileWriter()



# in this part of the code, we get every file in pdf, open and get a object for each one of them
for filename in pdf_files:
    pdf_file_object=open(filename,'rb')
    pdf_reader=PyPDF2.PdfFileReader(pdf_file_object)

#Still in the same idea, now its time get all the pages from them, except the first page
for page in range(1,pdf_reader.numPages):
    page_object = pdf_reader.getPage(page)
    pdf_writer_object.addPage(page_object)

# and finally'(at last)',we will now save all of them in a single file
pdf_final=open('allminutes.pdf','wb')
pdf_writer.write(pdf_final)
pdf_final.close()


###### nao funciona linha 21 porque é necessario pegar o pdf e substitui-lo por outro funcional.
###### ou ainda apenas seria necessario exectuar o qpdf, um processo para cair numa variavel e consertar o arquivo.


##################################### trabalhando com arquivos Word ###############################################
import docx

doc=docx.Document('demo.docx')
#len(doc.paragraphs)

#doc.paragraphs[0].text

#doc.paragraphs[1].text

len(doc.paragraphs[1].runs)

"""
doc.paragraphs[1].runs[0].text
doc.paragraphs[1].runs[1].text
doc.paragraphs[1].runs[2].text
doc.paragraphs[1].runs[3].text
doc.paragraphs[1].runs[4].text
"""
